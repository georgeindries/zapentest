const { getZapClient } = require('../client/zaproxy-client');

exports.createContext = (contextName) => {
  const zaproxy = getZapClient();
  return zaproxy.context.newContext(contextName)
    .then((res) => res)
    .catch((err) => {
      throw err;
    });
};

exports.includeUrlInContext = (contextName, url) => {
  const zaproxy = getZapClient();
  return zaproxy.context.includeInContext(contextName, `${url}.*`)
    .then((res) => res)
    .catch((err) => {
      throw err;
    });
};

exports.getContextByName = (contextName) => {
  const zaproxy = getZapClient();
  return zaproxy.context.context(contextName)
    .then((res) => res.context)
    .catch((err) => {
      throw err;
    });
};
